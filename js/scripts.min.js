var Page={init:function(){console.log("Page.init"),this.bindEvents(),$("#preview_page").length&&this.previewLazyLoad(),$(".article").length&&(this.imagesPrep(),this.singleLazyLoad()),$(".news_cols").length&&this.newsPrep()},bindEvents:function(){console.log("Page.bindEvents");var a=this;$("#alphabetical_sorting").on("click",function(){a.sortList("alphabetical")}),$("#chronological_sorting").on("click",function(){a.sortList("chronological")}),$("body").on("click",".lightbox_next",function(b){b.preventDefault(),a.lightboxNext()}),$("body").on("click",".lightbox_prev",function(){a.lightboxPrev()}),$("body").on("click",".lightbox_close",function(){a.closePopup()})},sortList:function(a){function b(a){console.log("descToggle"),d.removeClass("asc").addClass("desc"),$("#"+a+"_sorting").siblings(".sort_desc").css("opacity","1").siblings(".sort_asc").css("opacity","0")}function c(a){console.log("ascToggle"),d.removeClass("desc").addClass("asc"),$("#"+a+"_sorting").siblings(".sort_asc").css("opacity","1").siblings(".sort_desc").css("opacity","0")}console.log("Page.sortList",a);var d=$("#archive_list"),e=d.children(".line").get();"alphabetical"===a?(d.hasClass("asc")?(e.sort(function(a,b){return $(a).text().toUpperCase().localeCompare($(b).text().toUpperCase())}),b(a)):(e.sort(function(a,b){return $(b).text().toUpperCase().localeCompare($(a).text().toUpperCase())}),c(a)),$(".title .right span").css("opacity","0")):"chronological"===a&&(d.hasClass("asc")?(e.sort(function(a,b){return $(b).attr("data-date").localeCompare($(a).attr("data-date"))}),b(a)):(e.sort(function(a,b){return $(a).attr("data-date").localeCompare($(b).attr("data-date"))}),c(a)),$(".title .left span").css("opacity","0")),$.each(e,function(a,b){d.append(b)})},loadingLoop:function(a,b){console.log("Page.loadingLoop");var c,d=this;c="img"===a?$(a).eq(b):$(a).eq(b).find("img"),c.attr("src",c.attr("data-src")).on("load",function(){$(a).eq(b).addClass("loaded"),b<$(a).length&&(b++,d.loadingLoop(a,b))})},previewLazyLoad:function(){console.log("Page.previewLazyLoad");var a,b=250,c=140,d=Math.floor($(window).width()/c),e=Math.floor($(window).height()/b),f=e*d,g=($(".preview").length,this);$(".preview").each(function(b){b<f&&(a=$(this).find("img"),a.attr("src",a.attr("data-src")),$(this).addClass("loaded"))}),$(window).one("scroll resize",function(){g.loadingLoop(".preview",f)})},singleLazyLoad:function(){console.log("Page.singleLazyLoad"),this.loadingLoop("img",0)},newsPrep:function(){console.log("Page.newsPrep"),$(".newsblock").each(function(){if($(this).find("img").each(function(){$(this).parent("a").length&&$(this).unwrap()}),!$(this).is(":empty")){var a=$(this).find(".news_item_content").html().trim().substring(0,4);"<img"===a&&$(this).find("img").first().css("margin-top","0")}})},imagesPrep:function(){console.log("Page.imagesPrep");var a=0;$(".article img").each(function(b){$(this).attr("data-count",b+1),a=b+1}),$(".article").attr("data-total",a)},openPopup:function(a){if(console.log("Page.openPopup"),$("#lightbox_bg").length<1){var b="<div id='lightbox_bg'><div id='img_wrapper'></div>";b+="<div id='lightbox_nav'>",b+="<span class='lightbox_count'></span><span class='lightbox_prev'>Previous</span><span class='lightbox_next'>Next</span><span class='lightbox_close'>Close</span>",b+="</div></div>",$("body").append(b)}var c=a.find("img").attr("src");c.indexOf("-small")!==-1?c=c.split("-small")[0]+c.split("-small")[1]:console.log(292),$("#img_wrapper").css("background-image","url("+c+")");var d=a.find("img").attr("data-count"),e=parseInt($(".article").attr("data-total"));$("#img_wrapper").attr("data-current",d),$(".lightbox_count").text(d+" of "+e),$("#lightbox_bg").show(),setTimeout(function(){$("#lightbox_bg").css("opacity","1")},100)},closePopup:function(){console.log("Page.closePopup"),$("#lightbox_bg").css("opacity",""),setTimeout(function(){$("#lightbox_bg").hide()},1e3)},lightboxNext:function(){console.log("Page.lightboxNext");var a,b=parseInt($("#img_wrapper").attr("data-current"));console.log($("#img_wrapper").attr("data-current"),$(".article").attr("data-total")),b<parseInt($(".article").attr("data-total"))?(a=$(".article img").eq(b).attr("src"),b++):(a=$(".article img").eq(0).attr("src"),b=1),$("#img_wrapper").attr("data-current",b),$(".lightbox_count").text(b+" of "+$(".article").attr("data-total")),$("#img_wrapper").css("background-image","url("+a+")")},lightboxPrev:function(){console.log("Page.lightboxPrev");var a,b=parseInt($("#img_wrapper").attr("data-current")-1),c=parseInt($(".article").attr("data-total"));console.log(353,b),b>0?(console.log(350),a=$(".article img").eq(b-1).attr("src")):(console.log(355),a=$(".article img").eq(c-1).attr("src"),b=c),$("#img_wrapper").attr("data-current",b),$(".lightbox_count").text(b+" of "+c),$("#img_wrapper").css("background-image","url("+a+")")}};$(document).on("ready",function(){Page.init()});